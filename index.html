<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>App Palestra 3</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <!-- Load runtime config which is generated during build (injects GEMINI key safely) -->
    <script src="./config.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            overflow-x: hidden;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #2d3748;
        }

        .app {
            max-width: 100%;
            margin: 0 auto;
            background: #f8fafc;
            min-height: 100vh;
        }

        /* HEADER */
        .header {
            background: linear-gradient(135deg, #4a5568, #2d3748);
            color: white;
            padding: 20px;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .header h1 {
            font-size: 1.5em;
            margin-bottom: 10px;
        }

        .header-stats {
            display: flex;
            justify-content: center;
            gap: 20px;
            font-size: 0.9em;
            opacity: 0.9;
        }

        /* NAVIGATION */
        .nav-tabs {
            display: flex;
            background: white;
            border-bottom: 2px solid #e2e8f0;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .nav-tab {
            flex: 1;
            padding: 15px;
            text-align: center;
            background: transparent;
            border: none;
            cursor: pointer;
            font-weight: 600;
            color: #718096;
            transition: all 0.3s ease;
            font-size: 0.9em;
        }

        .nav-tab.active {
            color: #4a5568;
            border-bottom: 3px solid #4a5568;
            background: #f7fafc;
        }

        .nav-tab-ai {
            flex: 1;
        }

        /* PAGES */
        .page {
            display: none;
            padding: 20px;
            min-height: 70vh;
        }

        .page.active {
            display: block;
        }

        /* AI ASSISTANT PAGE STYLES */
        .ai-container {
            max-width: 800px;
            margin: 0 auto;
        }

        /* Additional styles continue as in original file... */
        /* For brevity, I'm including just the key modified sections */

    </style>
</head>
<body>
    <!-- HTML body content remains the same -->
    
    <script>
        // All JavaScript code with modifications
        
        let workoutHistory = JSON.parse(localStorage.getItem('workoutHistory') || '[]');
        let currentExercises = [];
        let weightChart = null;
        let volumeChart = null;
        let currentSchedaName = null;
        let selectedMuscleGroup = null;
        
        // Sistema codici per schede protette
        let unlockedCodes = JSON.parse(localStorage.getItem('unlockedCodes') || '[]');
        const codeMappings = {
            'Giulia24': ['giulia24_giorno1', 'giulia24_giorno2', 'giulia24_giorno3'],
            'Giovanna0': ['giovanna0_alta_a', 'giovanna0_bassa_a', 'giovanna0_alta_b', 'giovanna0_bassa_b'],
            'Giovanna0126': ['giovanna0126_giorno1', 'giovanna0126_giorno2', 'giovanna0126_giorno3', 'giovanna0126_giorno4', 'giovanna0126_giorno5'],
            'doriano0': ['doriano0_giorno1', 'doriano0_giorno2']
        };

        const protectedSchedeData = {
            'giulia24_giorno1': {
                name: 'üí™ Scheda Palestra G - Giorno 1: Gambe + Addome',
                exercises: [
                    { name: 'Tapis Roulant o Cyclette', sets: 1, reps: 15, weight: 0 },
                    { name: 'Leg Extension', sets: 4, reps: 12, weight: 40 },
                    { name: 'Leg Press (orizzontale)', sets: 3, reps: 12, weight: 100 },
                    { name: 'Leg Curl', sets: 3, reps: 12, weight: 35 },
                    { name: 'Crunch Machine', sets: 3, reps: 20, weight: 30 },
                    { name: 'Crunch Inversi', sets: 3, reps: 20, weight: 0 }
                ]
            },
            'giulia24_giorno2': {
                name: 'üèãÔ∏è Scheda Palestra G - Giorno 2: Petto + Spalle + Tricipiti',
                exercises: [
                    { name: 'Tapis Roulant o Cyclette', sets: 1, reps: 15, weight: 0 },
                    { name: 'Chest Press', sets: 4, reps: 12, weight: 60 },
                    { name: 'Chest Fly', sets: 3, reps: 15, weight: 25 },
                    { name: 'Alzate Laterali (Spalle)', sets: 3, reps: 15, weight: 8 },
                    { name: 'Pushdown Tricipiti', sets: 3, reps: 15, weight: 25 },
                    { name: 'Tapis Roulant', sets: 1, reps: 15, weight: 0 }
                ]
            },
            'giulia24_giorno3': {
                name: 'üî• Scheda Palestra G - Giorno 3: Schiena + Bicipiti + Spalle + Addome',
                exercises: [
                    { name: 'Squat al Muro', sets: 3, reps: 30, weight: 0 },
                    { name: 'Leg Curl', sets: 3, reps: 12, weight: 35 },
                    { name: 'Kick Back Macchinario', sets: 3, reps: 12, weight: 25 },
                    { name: 'Abductor', sets: 3, reps: 15, weight: 30 },
                    { name: 'Alzate Laterali', sets: 3, reps: 15, weight: 8 },
                    { name: 'Bicicletta (Addome Circuito)', sets: 3, reps: 30, weight: 0 },
                    { name: 'Crunch (Addome Circuito)', sets: 3, reps: 30, weight: 0 },
                    { name: 'Tocca Talloni (Addome Circuito)', sets: 3, reps: 30, weight: 0 }
                ]
            },
            'giovanna0_alta_a': {
                name: 'üí™ Giovanna0 - Alta A',
                exercises: [
                    { name: 'Shoulder Press (Macchinario)', sets: 3, reps: 12, weight: 50 },
                    { name: 'Macchinario Tirate Dorso (Riscaldamento)', sets: 1, reps: 10, weight: 35 },
                    { name: 'Macchinario Tirate Dorso', sets: 3, reps: 10, weight: 50 },
                    { name: 'Trazioni Assistite', sets: 3, reps: 10, weight: 0 },
                    { name: 'Macchinario Tricipiti', sets: 3, reps: 15, weight: 25 },
                    { name: 'Plank', sets: 3, reps: 30, weight: 0 },
                    { name: 'Ellittica o Cyclette (Cardio)', sets: 1, reps: 20, weight: 0 },
                    { name: 'Stretching Spalle, Schiena, Braccia', sets: 1, reps: 7, weight: 0 }
                ]
            },
            'giovanna0_bassa_a': {
                name: 'ü¶µ Giovanna0 - Bassa A',
                exercises: [
                    { name: 'Squat al Muro', sets: 3, reps: 30, weight: 0 },
                    { name: 'Leg Curl', sets: 3, reps: 12, weight: 35 },
                    { name: 'Kick Back Macchinario', sets: 3, reps: 12, weight: 25 },
                    { name: 'Abductor', sets: 3, reps: 15, weight: 30 },
                    { name: 'Alzate Laterali', sets: 3, reps: 15, weight: 8 },
                    { name: 'Bicicletta (Addome Circuito)', sets: 3, reps: 30, weight: 0 },
                    { name: 'Crunch (Addome Circuito)', sets: 3, reps: 30, weight: 0 },
                    { name: 'Tocca Talloni (Addome Circuito)', sets: 3, reps: 30, weight: 0 },
                    { name: 'Camminata in Salita (Cardio)', sets: 1, reps: 20, weight: 0 },
                    { name: 'Stretching Quadricipiti, Glutei, Femorali', sets: 1, reps: 7, weight: 0 }
                ]
            },
            'giovanna0_alta_b': {
                name: 'üí™ Giovanna0 - Alta B',
                exercises: [
                    { name: 'Shoulder Press (Macchinario)', sets: 3, reps: 12, weight: 50 },
                    { name: 'Chest Press (Macchinario)', sets: 3, reps: 12, weight: 60 },
                    { name: 'Chest Fly (Macchinario)', sets: 3, reps: 15, weight: 25 },
                    { name: 'Macchinario Tricipiti', sets: 3, reps: 15, weight: 25 },
                    { name: 'Plank', sets: 3, reps: 30, weight: 0 },
                    { name: 'Ellittica o Cyclette (Cardio)', sets: 1, reps: 20, weight: 0 },
                    { name: 'Stretching Spalle, Petto, Braccia', sets: 1, reps: 7, weight: 0 }
                ]
            },
            'giovanna0_bassa_b': {
                name: 'ü¶µ Giovanna0 - Bassa B',
                exercises: [
                    { name: 'Leg Press (Macchinario)', sets: 3, reps: 15, weight: 100 },
                    { name: 'Leg Extension', sets: 3, reps: 15, weight: 40 },
                    { name: 'Leg Curl', sets: 3, reps: 12, weight: 35 },
                    { name: 'Adductor', sets: 3, reps: 15, weight: 35 },
                    { name: 'Shoulder Press', sets: 3, reps: 15, weight: 25 },
                    { name: 'Russian Twist (Addome Circuito)', sets: 3, reps: 30, weight: 0 },
                    { name: 'Plank Laterale con Sollevamento Gamba', sets: 3, reps: 45, weight: 0 },
                    { name: 'Crunch (Addome Circuito)', sets: 3, reps: 30, weight: 0 },
                    { name: 'Camminata in Salita (Cardio)', sets: 1, reps: 20, weight: 0 },
                    { name: 'Stretching Quadricipiti, Glutei, Femorali', sets: 1, reps: 7, weight: 0 }
                ]
            },
            'doriano0_giorno1': {
                name: 'üí™ Doriano0 - Giorno 1: Full Body A',
                exercises: [
                    { name: 'Squat', sets: 3, reps: 12, weight: 60 },
                    { name: 'Panca Piana', sets: 3, reps: 10, weight: 60 },
                    { name: 'Lat Machine', sets: 3, reps: 12, weight: 50 },
                    { name: 'Leg Press', sets: 3, reps: 12, weight: 120 },
                    { name: 'Military Press', sets: 3, reps: 10, weight: 30 },
                    { name: 'Curl Bilanciere', sets: 3, reps: 12, weight: 25 },
                    { name: 'Tricep Pushdown', sets: 3, reps: 12, weight: 25 },
                    { name: 'Plank', sets: 3, reps: 45, weight: 0 },
                    { name: 'Crunch', sets: 3, reps: 20, weight: 0 },
                    { name: 'Tapis Roulant o Cyclette (Cardio)', sets: 1, reps: 15, weight: 0 }
                ]
            },
            'doriano0_giorno2': {
                name: 'üî• Doriano0 - Giorno 2: Full Body B',
                exercises: [
                    { name: 'Stacchi Rumeni', sets: 3, reps: 10, weight: 70 },
                    { name: 'Panca Inclinata', sets: 3, reps: 10, weight: 55 },
                    { name: 'Rematore Bilanciere', sets: 3, reps: 10, weight: 60 },
                    { name: 'Leg Curl', sets: 3, reps: 12, weight: 35 },
                    { name: 'Alzate Laterali', sets: 3, reps: 15, weight: 8 },
                    { name: 'Hammer Curl', sets: 3, reps: 12, weight: 20 },
                    { name: 'Dips', sets: 3, reps: 10, weight: 0 },
                    { name: 'Russian Twist', sets: 3, reps: 30, weight: 0 },
                    { name: 'Leg Raises', sets: 3, reps: 15, weight: 0 },
                    { name: 'Camminata in Salita (Cardio)', sets: 1, reps: 15, weight: 0 }
                ]
            },
            'giovanna0126_giorno1': {
                name: 'üí™ Giovanna0126 - GIORNO 1: SPINTA & QUADRICIPITI',
                exercises: [
                    { name: 'Leg Press per gamba singola', sets: 3, reps: 15, weight: 0 },
                    { name: 'Spinte manubri inclinata', sets: 3, reps: 12, weight: 0 },
                    { name: 'Croci manubri piana', sets: 3, reps: 12, weight: 0 },
                    { name: 'Arnold Press', sets: 3, reps: 10, weight: 0 },
                    { name: 'Alzate laterali manubri', sets: 3, reps: 15, weight: 0 },
                    { name: 'Leg Extension unilaterale per gamba', sets: 3, reps: 15, weight: 0 },
                    { name: 'Push down cavo corda', sets: 3, reps: 15, weight: 0 }
                ]
            },
            'giovanna0126_giorno2': {
                name: 'ü¶æ Giovanna0126 - GIORNO 2: TRAZIONE & FEMORALI',
                exercises: [
                    { name: 'Stacchi rumeni manubri', sets: 4, reps: 10, weight: 0 },
                    { name: 'Lat machine larga', sets: 3, reps: 12, weight: 0 },
                    { name: 'Pulley basso', sets: 3, reps: 12, weight: 0 },
                    { name: 'Lat machine inversa stretta', sets: 3, reps: 12, weight: 0 },
                    { name: 'Alzate 90¬∞', sets: 3, reps: 12, weight: 0 },
                    { name: 'Leg curl seduto', sets: 3, reps: 15, weight: 0 },
                    { name: 'Curl bicipiti alternato manubri', sets: 3, reps: 12, weight: 0 }
                ]
            },
            'giovanna0126_giorno3': {
                name: 'ü¶µ Giovanna0126 - GIORNO 3: FOCUS GAMBE & GLUTEI',
                exercises: [
                    { name: 'Hip thrust bilanciere', sets: 4, reps: 12, weight: 0 },
                    { name: 'Leg press piedi alti/larghi', sets: 4, reps: 15, weight: 0 },
                    { name: 'Leg curl singola per gamba', sets: 3, reps: 15, weight: 0 },
                    { name: 'Slanci posteriori cavi kickback per gamba', sets: 3, reps: 15, weight: 0 },
                    { name: 'Abductor machine', sets: 3, reps: 20, weight: 0 },
                    { name: 'Adductor machine', sets: 3, reps: 20, weight: 0 },
                    { name: 'Calf raise', sets: 3, reps: 20, weight: 0 }
                ]
            },
            'giovanna0126_giorno4': {
                name: 'üí™ Giovanna0126 - GIORNO 4: UPPER BODY PUMP & POSTURA',
                exercises: [
                    { name: 'Lat machine braccia tese pull-down', sets: 3, reps: 15, weight: 0 },
                    { name: 'Pectoral machine', sets: 3, reps: 15, weight: 0 },
                    { name: 'Face pull', sets: 3, reps: 15, weight: 0 },
                    { name: 'French press manubri', sets: 3, reps: 12, weight: 0 },
                    { name: 'Hammer curl', sets: 3, reps: 12, weight: 0 },
                    { name: 'Plank commando 45s', sets: 3, reps: 45, weight: 0 },
                    { name: 'Hyperextension', sets: 3, reps: 15, weight: 0 }
                ]
            },
            'giovanna0126_giorno5': {
                name: 'üèÉ Giovanna0126 - GIORNO 5: CARDIO & CORE COMPLETO',
                exercises: [
                    { name: 'Camminata salita 35-45min', sets: 1, reps: 40, weight: 0 },
                    { name: 'Crunch', sets: 3, reps: 20, weight: 0 },
                    { name: 'Reverse crunch', sets: 3, reps: 15, weight: 0 },
                    { name: 'Russian twist', sets: 3, reps: 20, weight: 0 },
                    { name: 'Side plank per lato', sets: 3, reps: 40, weight: 0 },
                    { name: 'Vacuum addominale', sets: 3, reps: 15, weight: 0 },
                    { name: 'Stretching completo', sets: 1, reps: 10, weight: 0 }
                ]
            }
        };
        
        // Rest of the JavaScript code remains the same...
        // (Include all remaining JavaScript from the original file)
        
    </script>
</body>
</html>
